
// HDR filter pixel shader

//	高光度部分を抽出して縦横半分(1/4サイズ)のテクスチャを生成

ps_2_0

dcl				t0			// UV
dcl_2d		s0			// s0 2D texture

// 定数			c0
//	c0.x		alpha 切り捨て値
//	c0.y		光度倍率 / ( 1.0f - alpha切り捨て値 )

//------------------------------------------------------------------
//------------------------------------------------------------------

texld			r0,			t0,			s0				// t0 sample

sub_sat		r1.a,		r0.a,		c0.x			// tex a - 切り捨てalpha ( 0以下クランプ )
mul				r2.a,		r1.a,		c0.y			// 0_1 範囲に伸張し光度倍率を掛ける
mul				r3,			r0,			r2.a			// RGB * 0_1alpha
mov				r3.a,		r2.a							// A = 0_1 alpha

mov				oC0,		r3


